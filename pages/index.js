import Head from 'next/head'
import Layout from '../components/layout'
import Header from '../components/header'
import Sidebar from '../components/sidebar'
import Main from '../components/main'
import Footer from '../components/footer'
import { useEffect } from 'react'
import getStreams from '../functions/get-streams'
import { useState } from 'react'
import getInfoUsers from '../functions/get-info-users'
import StreamsList from '../components/streams-list'


export default function Home({streamsData, userData}) {

  return (
    <Layout>
      <Head>
        <title>The Best Streaming</title>
        <meta name="description" content="Generated by create next app" />
      </Head>

      <Header />
      <Sidebar
        streams={streamsData ? streamsData.data : null}
        userData={userData ? userData.data : null} 
      />
      <Main>
        <StreamsList 
          streams={streamsData ? streamsData.data : null}
          userData={userData ? userData.data : null} />
      </Main>
      <Footer />
    </Layout>
  )
}

export async function getServerSideProps(){
  const streamsData = await getStreams()
  const userData = await getInfoUsers(streamsData.data)

  return {
    props: {
      streamsData,
      userData
    }
  }
}
